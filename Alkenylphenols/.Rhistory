df_all$I_pdw<-as.numeric(as.character(df_all$I_pdw))
df_all$J_pdw<-as.numeric(as.character(df_all$J_pdw))
df_all$tissue<-as.factor(df_all$tissue)
df_all$plant<-as.factor(df_all$plant)
df_all$stage<-as.factor(df_all$stage)
#gather rows into columns, more data cleaning
datall <- gather(df_all, "compound", "per_dry_wt", 5:14)
datall$per_dry_wt<-as.numeric(datall$per_dry_wt)
datall$compound<-as.character(datall$compound)
datall$stage<-as.character(datall$stage)
#dry weight % -> proportions
datall$props<-(datall$per_dry_wt/100)
##splitting between tissue types
##only leaves
dfl <- filter(datall, tissue == "L")
##only pulp
dat <- filter(datall, tissue == "P")
#labeling
datall <- datall[order(datall$tissue),]
datall <- datall[order(datall$stage),]
datall$tissue<-as.character(datall$tissue)
datall$plant<-as.character(datall$plant)
#sep stages within tissues
datall$tissue[1:200]<-"R"
datall$tissue[261:470]<-"U2"
datall$tissue[471:660]<-"U3"
datall$tissue[661:870]<-"F4"
datall$tissue[871:1020]<-"F5"
datall$tissue[1021:1130]<-"F6"
datall$tissue[datall$tissue=="R"]="Ripe pulp (1)"
datall$tissue[datall$tissue=="U2"]="Unripe pulp (2)"
datall$tissue[datall$tissue=="U3"]="Unripe pulp (3)"
datall$tissue[datall$tissue=="F4"]="Flowers (4)"
datall$tissue[datall$tissue=="F5"]="Flowers (5)"
datall$tissue[datall$tissue=="F6"]="Dev. flowers (6)"
datall$tissue[datall$tissue=="S"]="Seeds"
datall$tissue[datall$stage=="M"]="Mature leaves"
datall$compound[datall$compound=="A_pdw"]="A"
datall$compound[datall$compound=="B_pdw"]="B"
datall$compound[datall$compound=="C_pdw"]="C"
datall$compound[datall$compound=="D_pdw"]="D"
datall$compound[datall$compound=="E_pdw"]="E"
datall$compound[datall$compound=="F_pdw"]="F"
datall$compound[datall$compound=="G_pdw"]="G"
datall$compound[datall$compound=="H_pdw"]="H"
datall$compound[datall$compound=="I_pdw"]="I"
datall$compound[datall$compound=="J_pdw"]="J"
#ANALYSIS
a5<-aggregate(props~tissue+plant, data=datall, FUN=sum)
beta1<-betareg(props~tissue, data=a5)
summary(beta1)
Anova(beta1)
d1<-emmeans(beta1,pairwise~tissue, type="response")
CLD(d1$emmeans,  Letters ='ABCDEFGHIJKLMNOPQRS')
##plot
tissueplot2<-ggplot(a5, aes(x=tissue, y=props)) +
geom_boxplot() + geom_point(aes(color=as.character(plant)))+
labs(x=" ", y="Total alkenylphenols (% dry wt)")+
theme_minimal()+
scale_x_discrete(limits=c("Dev. flowers (6)",
"Flowers (5)","Flowers (4)","Unripe pulp (3)", "Unripe pulp (2)",
"Ripe pulp (1)","Seeds","Exp. leaves", "Mature leaves"))+
scale_color_manual(values=as.vector(kelly(21)), name = "Plant ID")
tissueplot2
##too busy, selecting representative stages for each tissue
##selecting representative stages for each tissue
##"Ripe pulp (1)","Unripe pulp (2)", "Flowers (4)","Seeds","Mature leaves"
datall <- datall[order(datall$stage),]
dat_select<-datall[c(1:470,661:870,1131:1170),]
#ANALYSIS
a10<-aggregate(props~tissue+plant, data=dat_select, FUN=sum)
beta10<-betareg(props ~ tissue, data=a10)
summary(beta10)
##selecting representative stages for each tissue
##"Ripe pulp (1)","Unripe pulp (2)", "Flowers (4)","Seeds","Mature leaves"
datall <- datall[order(datall$stage),]
##selecting representative stages for each tissue
##"Ripe pulp (1)","Unripe pulp (2)", "Flowers (4)","Seeds","Mature leaves"
datall <- datall[order(datall$stage),]
dat_select<-datall[c(1:470,661:870,1131:1170),]
#ANALYSIS
a10<-aggregate(props~tissue+plant, data=dat_select, FUN=sum)
beta10<-betareg(props ~ tissue, data=a10)
summary(beta10)
d10<-emmeans(beta10,pairwise~tissue, type="response")
d10
CLD(d10$emmeans,  Letters ='ABCDEFGHIJKLMNOPQRS')
#creating columns for stage as continuous variable and stage^2 (quadratic term)
dat[is.na(dat)] <- 0
dat$stage2 = (as.numeric(dat$stage))^2
dat$stage.num = as.numeric(dat$stage)
#aggregating dataset so each point=one plant and isn't sep by compound
ag_dat<-aggregate(props~plant+stage.num+stage2,data=dat,FUN=sum)
ag_dat$plant<-as.character(ag_dat$plant)
#betaregression with quadratic term
beta12<-betareg(props~stage.num+stage2 , data=ag_dat)
#regular betaregression
beta13<-betareg(props~stage.num, data=ag_dat)
null.mod<-betareg(props~1, data=ag_dat)
modcomp<-aictab(cand.set=list(beta12,beta13,null.mod),
modnames=c("nonlinear","linear","null"))#AIC table
modcomp
summary(beta12)#stage and quad. term are significant
modcomp
View(a10)
tissue.tab <- ddply(a10, c("tissue"), summarise,
N    = length(props),
mean = mean(props),
sd   = sd(props),
se   = sd / sqrt(N))
#SUMMARY STATS
library(plyr)
tissue.tab <- ddply(a10, c("tissue"), summarise,
N    = length(props),
mean = mean(props),
sd   = sd(props),
se   = sd / sqrt(N))
tissue.tab
3.923867e-02/2.707377e-02
3.923867e-02/1.533097e-02
3.923867e-02/1.085352e-03
3.923867e-02/7.335458e-05
#SUMMARY STATS
library(plyr)
dev.tab <- ddply(ag_dat, c("tissue"), summarise,
N    = length(props),
mean = mean(props),
sd   = sd(props),
se   = sd / sqrt(N))
dev.tab <- ddply(ag_dat, c("stage"), summarise,
N    = length(props),
mean = mean(props),
sd   = sd(props),
se   = sd / sqrt(N))
ag_dat
dev.tab <- ddply(ag_dat, c("stage.num"), summarise,
N    = length(props),
mean = mean(props),
sd   = sd(props),
se   = sd / sqrt(N))
dev.tab
0.027073768/0.039238673
0.027073768/0.030825459
(0.027073768/0.039238673)*100
(0.027073768/0.015330966)*100
(0.027073768/0.009078647)*100
(0.027073768/0.005129660)*100
3.923867e-02/2.707377e-02 *100
3.923867e-02/1.533097e-02
[1] 2.559438
> 3.923867e-02/1.085352e-03
[1] 36.15294
> 3.923867e-02/7.335458e-05
[1] 534.9178
tissue.tab
(3.923867e-02/2.707377e-02)* 100
(3.923867e-02/1.533097e-02)* 100
(3.923867e-02/1.085352e-03)* 100
(3.923867e-02/7.335458e-05)* 100
animal <- read.csv(file="Maynard_etal_AlkenylphenolAnimalTrials.csv",head=TRUE)
#only animals that participated
animal<-animal%>%
filter(participate==1)
#separating bats and birds
bat<-slice(animal, 1:32)
bird<-slice(animal, 33:58)
birdg <- gather(bird, "treatment", "amount_eaten", 17:18)
birdg$amount_eaten<-as.numeric(birdg$amount_eaten)
birdg$amount_eaten[birdg$amount_eaten>3] <- 3
birdg$treatment<-as.character(birdg$treatment)
bird_ag<-aggregate(amount_eaten~ID+treatment, data=birdg, FUN=mean)
bird_1<-spread(data=bird_ag, treatment, amount_eaten)
shapiro.test(bird_1$c.eaten)#norm dist
shapiro.test(bird_1$t.eaten)#norm dist
batg <- gather(bat, "treatment", "amount_eaten", 17:18)
batg$amount_eaten<-as.numeric(batg$amount_eaten)
batg$treatment<-as.character(batg$treatment)
bat_ag<-aggregate(amount_eaten~ID+treatment, data=batg, FUN=mean)
bat_1<-spread(data=bat_ag, treatment, amount_eaten)
shapiro.test(bat_1$c.eaten)#not norm dist?
shapiro.test(bat_1$t.eaten)#norm dist
t.test(bird_1$c.eaten, bird_1$t.eaten, paired = T)#t=0.30,df=9,p=0.775
t.test(bat_1$c.eaten, bat_1$t.eaten, paired = T)#t=2.73,df=16,p=0.015
#change names for graph
bat_ag$treatment[bat_ag$treatment=="t.eaten"]="Treatment"
bat_ag$treatment[bat_ag$treatment=="c.eaten"]="Control"
bird_ag$treatment[bird_ag$treatment=="t.eaten"]="Treatment"
bird_ag$treatment[bird_ag$treatment=="c.eaten"]="Control"
batpref<-ggplot(bat_ag,aes(x=treatment,y=amount_eaten))+geom_boxplot()+
geom_jitter(position=position_jitter(width = 0.03), alpha=0.5, size=1.7)+
theme_classic()+
labs(x=" ",y="Average amount eaten (g)")+
scale_y_continuous(limits =  c(0,3))+
theme(text = element_text(size = 18))
batpref
birdpref<-ggplot(bird_ag,aes(x=treatment,y=amount_eaten))+geom_boxplot()+
geom_jitter(position=position_jitter(width = 0.03), alpha=0.5,size=1.7)+
theme_classic()+
labs(x=" ",y="")+
scale_y_continuous(limits =  c(0,3.00))+
theme(text = element_text(size = 18))
birdpref
tiff('animal_pref.tiff', units="in", width=8, height=4, res=500)
ggarrange(batpref, birdpref,
labels = c("a", "b"),heights = c(2, 2),
ncol = 2, nrow = 1, align = "v")
dev.off()
####Removal study####
remo <- read.csv(file="Maynard_etal_PiperRemovalStudy.csv",head=TRUE,fill=T)
remo<-remo[-c(71),]
remo$Ripeness <- NA
for(i in 1:length(remo$Ripeness)){
if(remo$ripeness[i]=="1"){remo$Ripeness[i]="Ripe"}
if(remo$ripeness[i]=="2"){remo$Ripeness[i]="Unripe"}
}
remo$Time <- NA
for(i in 1:length(remo$Time)){
if(remo$time.of.day[i]=="1"){remo$Time[i]="Nocturnal"}
if(remo$time.of.day[i]=="2"){remo$Time[i]="Diurnal"}
}
tbl = table(remo$Ripeness, remo$Time)
tbl
chisq.test(tbl)
tbl.1 = table(remo$Time, remo$Ripeness)
tbl.1
chisq.test(tbl.1)
tbl2<-as.data.frame.matrix(tbl)
tbl2
tbl3<-as.data.frame(tbl)
tbl3
bp <- ggplot(tbl3, aes(x=Var2, y=Freq, fill=Var1))+
geom_bar(aes(fill=Var1),stat = "identity", position = "stack")+
theme_classic()+
labs(x="", y="No. of fruits removed",fill="")+
theme(text = element_text(size = 18))+
scale_fill_manual(values=c('#006837','#addd8e'))
bp
animal.plot<-ggarrange(batpref, birdpref,
labels = c("a", "b"),heights = c(2, 2),
ncol = 2, nrow = 1, align = "v")
library(ggplot2)
library(dplyr)
library(tidyr)
library(Rmisc)
library(reshape)
library(multcomp)
library(MASS)
library(RColorBrewer)
library(ggplot2)
library(multcompView)
library(emmeans)
library(lme4)
library(AICcmodavg)
library(betareg)
library(car)
library(viridis)
library(knitr)
library(kableExtra)
library(tinytex)
library(ggpubr)
library(pals)
batpref<-ggplot(bat_ag,aes(x=treatment,y=amount_eaten))+geom_boxplot()+
geom_jitter(position=position_jitter(width = 0.03), alpha=0.5, size=1.7)+
theme_classic()+
labs(x=" ",y="Average amount eaten (g)")+
scale_y_continuous(limits =  c(0,3))+
theme(text = element_text(size = 18))
batpref
birdpref<-ggplot(bird_ag,aes(x=treatment,y=amount_eaten))+geom_boxplot()+
geom_jitter(position=position_jitter(width = 0.03), alpha=0.5,size=1.7)+
theme_classic()+
labs(x=" ",y="")+
scale_y_continuous(limits =  c(0,3.00))+
theme(text = element_text(size = 18))
birdpref
animal.plot<-ggarrange(batpref, birdpref,
labels = c("a", "b"),heights = c(2, 2),
ncol = 2, nrow = 1, align = "v")
animal <- read.csv(file="Maynard_etal_AlkenylphenolAnimalTrials.csv",head=TRUE)
#only animals that participated
animal<-animal%>%
filter(participate==1)
#separating bats and birds
bat<-slice(animal, 1:32)
bird<-slice(animal, 33:58)
birdg <- gather(bird, "treatment", "amount_eaten", 17:18)
birdg$amount_eaten<-as.numeric(birdg$amount_eaten)
birdg$amount_eaten[birdg$amount_eaten>3] <- 3
birdg$treatment<-as.character(birdg$treatment)
bird_ag<-aggregate(amount_eaten~ID+treatment, data=birdg, FUN=mean)
bird_1<-spread(data=bird_ag, treatment, amount_eaten)
shapiro.test(bird_1$c.eaten)#norm dist
shapiro.test(bird_1$t.eaten)#norm dist
batg <- gather(bat, "treatment", "amount_eaten", 17:18)
batg$amount_eaten<-as.numeric(batg$amount_eaten)
batg$treatment<-as.character(batg$treatment)
bat_ag<-aggregate(amount_eaten~ID+treatment, data=batg, FUN=mean)
bat_1<-spread(data=bat_ag, treatment, amount_eaten)
shapiro.test(bat_1$c.eaten)#not norm dist?
shapiro.test(bat_1$t.eaten)#norm dist
t.test(bird_1$c.eaten, bird_1$t.eaten, paired = T)#t=0.30,df=9,p=0.775
t.test(bat_1$c.eaten, bat_1$t.eaten, paired = T)#t=2.73,df=16,p=0.015
#change names for graph
bat_ag$treatment[bat_ag$treatment=="t.eaten"]="Treatment"
bat_ag$treatment[bat_ag$treatment=="c.eaten"]="Control"
bird_ag$treatment[bird_ag$treatment=="t.eaten"]="Treatment"
bird_ag$treatment[bird_ag$treatment=="c.eaten"]="Control"
batpref<-ggplot(bat_ag,aes(x=treatment,y=amount_eaten))+geom_boxplot()+
geom_jitter(position=position_jitter(width = 0.03), alpha=0.5, size=1.7)+
theme_classic()+
labs(x=" ",y="Average amount eaten (g)")+
scale_y_continuous(limits =  c(0,3))+
theme(text = element_text(size = 18))
batpref
birdpref<-ggplot(bird_ag,aes(x=treatment,y=amount_eaten))+geom_boxplot()+
geom_jitter(position=position_jitter(width = 0.03), alpha=0.5,size=1.7)+
theme_classic()+
labs(x=" ",y="")+
scale_y_continuous(limits =  c(0,3.00))+
theme(text = element_text(size = 18))
birdpref
animal.plot<-ggarrange(batpref, birdpref,
labels = c("a", "b"),heights = c(2, 2),
ncol = 2, nrow = 1, align = "v")
animal.plot
animal <- read.csv(file="Maynard_etal_AlkenylphenolAnimalTrials.csv",head=TRUE)
#only animals that participated
animal<-animal%>%
filter(participate==1)
#separating bats and birds
bat<-slice(animal, 1:32)
bird<-slice(animal, 33:58)
birdg <- gather(bird, "treatment", "amount_eaten", 17:18)
birdg$amount_eaten<-as.numeric(birdg$amount_eaten)
birdg$amount_eaten[birdg$amount_eaten>3] <- 3
birdg$treatment<-as.character(birdg$treatment)
bird_ag<-aggregate(amount_eaten~ID+treatment, data=birdg, FUN=mean)
bird_1<-spread(data=bird_ag, treatment, amount_eaten)
shapiro.test(bird_1$c.eaten)#norm dist
shapiro.test(bird_1$t.eaten)#norm dist
View(animal)
animal <- read.csv(file="Maynard_etal_AlkenylphenolAnimalTrials.csv",head=TRUE)
#only animals that participated
animal<-animal%>%
filter(participate==1)
#separating bats and birds
bat<-slice(animal, 1:32)
bird<-slice(animal, 33:58)
View(bat)
#separating bats and birds
bat<-slice(animal, 1:31)
bird<-slice(animal, 32:58)
birdg <- gather(bird, "treatment", "amount_eaten", 17:18)
View(bird)
birdg <- gather(bird, "treatment", "amount_eaten", 18:19)
birdg$amount_eaten<-as.numeric(birdg$amount_eaten)
birdg$amount_eaten[birdg$amount_eaten>3] <- 3
birdg$treatment<-as.character(birdg$treatment)
bird_ag<-aggregate(amount_eaten~ID+treatment, data=birdg, FUN=mean)
bird_1<-spread(data=bird_ag, treatment, amount_eaten)
shapiro.test(bird_1$c.eaten)#norm dist
shapiro.test(bird_1$t.eaten)#norm dist
animal <- read.csv(file="Maynard_etal_AlkenylphenolAnimalTrials.csv",head=TRUE)
#only animals that participated
animal<-animal%>%
filter(participate==1)
#separating bats and birds
bat<-slice(animal, 1:31)
bird<-slice(animal, 32:58)
birdg <- gather(bird, "treatment", "amount_eaten", 17:18)
birdg$amount_eaten<-as.numeric(birdg$amount_eaten)
birdg$amount_eaten[birdg$amount_eaten>3] <- 3
birdg$treatment<-as.character(birdg$treatment)
bird_ag<-aggregate(amount_eaten~ID+treatment, data=birdg, FUN=mean)
bird_1<-spread(data=bird_ag, treatment, amount_eaten)
shapiro.test(bird_1$c.eaten)#norm dist
shapiro.test(bird_1$t.eaten)#norm dist
batg <- gather(bat, "treatment", "amount_eaten", 17:18)
batg$amount_eaten<-as.numeric(batg$amount_eaten)
batg$treatment<-as.character(batg$treatment)
bat_ag<-aggregate(amount_eaten~ID+treatment, data=batg, FUN=mean)
bat_1<-spread(data=bat_ag, treatment, amount_eaten)
shapiro.test(bat_1$c.eaten)#not norm dist?
shapiro.test(bat_1$t.eaten)#norm dist
shapiro.test(bat_1$t.eaten)#not norm dist?
shapiro.test(bat_1$c.eaten)#norm dist
t.test(bird_1$c.eaten, bird_1$t.eaten, paired = T)#t=0.30,df=9,p=0.775
t.test(bird_1$c.eaten, bird_1$t.eaten, paired = T)#t=0.30,df=9,p=0.775
t.test(bat_1$c.eaten, bat_1$t.eaten, paired = T)#t=2.73,df=16,p=0.015
bat_ag
bat.tab <- ddply(bat_ag, c("treatment"), summarise,
N    = length(amount_eaten),
mean = mean(amount_eaten),
sd   = sd(amount_eaten),
se   = sd / sqrt(N))
bat.tab
bat.tab <- ddply(bat_ag, c("treatment"), summarise,
N    = length(amount_eaten),
mean = mean(amount_eaten),
sd   = sd(amount_eaten),
se   = sd / sqrt(N))
bat.tab
bird.tab <- ddply(bird_ag, c("treatment"), summarise,
N    = length(amount_eaten),
mean = mean(amount_eaten),
sd   = sd(amount_eaten),
se   = sd / sqrt(N))
bird.tab
(0.5859531/1.4278438)*100
(1.233967/1.347717)*100
(1.347717/1.233967)*100
(1.347717-1.233967)/1.347717
0.08440199*100
#EXPORT TABLE
write.table(dev.tab, file = "TableS5.csv", sep = ",", quote = FALSE, row.names = F)
#EXPORT TABLE
write.table(tissue.tab, file = "TableS4.csv", sep = ",", quote = FALSE, row.names = F)
bat.tab
bird.tab
library(tidyverse)
install.packages("tidyverse")
library(tidyverse)
library(knitr)
library(lme4)
library(visreg)
install.packages("visreg")
library(tidyverse)
library(knitr)
library(lme4)
library(visreg)
library(AMR)
install.packages("AMR")
library(tidyverse)
library(knitr)
library(lme4)
library(visreg)
library(AMR)
library(vegan)
install.packages("vegan")
library(tidyverse)
library(knitr)
library(lme4)
library(visreg)
library(AMR)
library(vegan)
library(kableExtra)
library(lmerTest) #for p-values in linear mixed effects model
install.packages("lmerTest")
library(tidyverse)
library(knitr)
library(lme4)
library(visreg)
library(AMR)
library(vegan)
library(kableExtra)
library(lmerTest) #for p-values in linear mixed effects model
file_list <- list.files(path= "data/micro_dilution_assay/2018/", pattern="R3_*") # create list of all .csv files in folder
# read in each .csv file in file_list and rbind them into a data frame called data
datalist <-
do.call("rbind",
lapply(file_list,
function(x)
read_csv(paste("data/micro_dilution_assay/2018/", x, sep=''))))
#Ignore the error message here, it's complaining about the way the data columns are named
head(datf)
datf <- read.csv(file="Maynard_etal_FungalBioassays.csv",head=TRUE,fill=T)
datf <- datf[1:81,]
datf$Conc<-as.numeric(datf$Conc)
datf$fungi<-as.character(datf$fungi)
datf$nfungi[datf$fungi=="R3"]="Microdochium lycopodium"
datf$nfungi[datf$fungi=="R23"]="Fusarium verticillioides"
datf$nfungi[datf$fungi=="R26"]="Fusarium sp."
mod.mix<-lmer(abs_corr~Conc*fungi+(1|well))
head(datf)
mod.mix<-lmer(abs_corr~Conc*fungi+(1|well), data=datf)
summary(mod.mix)
Anova(mod.mix)
View(datf)
#average triplicates
ag.fun<-aggregate(abs_corr~conc+fungi, data=datf, FUN=mean)
#average triplicates
ag.fun<-aggregate(abs_corr~Conc+fungi, data=datf, FUN=mean)
mod.mix<-lmer(abs_corr~Conc*fungi+(1|well), data=ag.fun)
#average triplicates
ag.fun<-aggregate(abs_corr~Conc+fungi+well, data=datf, FUN=mean)
mod.mix<-lmer(abs_corr~Conc*fungi+(1|well), data=ag.fun)
View(ag.fun)
mod.mix<-lm(abs_corr~Conc*fungi, data=ag.fun)
summary(mod.mix)
Anova(mod.mix)
fun.tab <- ddply(ag.fun, c("fungi", "Conc"), summarise,
N    = length(abs_corr),
mean = mean(abs_corr),
sd   = sd(abs_corr),
se   = sd / sqrt(N))
fun.tab
fun.tab <- ddply(ag.fun, c("fungi"), summarise,
N    = length(abs_corr),
mean = mean(abs_corr),
sd   = sd(abs_corr),
se   = sd / sqrt(N))
fun.tab
?Anova
mod.fun<-lm(abs_corr~Conc*fungi, data=ag.fun)
summary(mod.fun)
Anova(mod.fun)
summary(mod.fun$fungi)$coefficients[2,2]
summary(mod.fun)$coef
summary(mod.fun)
Anova(mod.fun)
summary(mod.fun)$coef
coef(mod.fun)
